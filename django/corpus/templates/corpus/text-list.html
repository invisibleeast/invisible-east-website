{% extends "base.html" %}
{% load static pagination_go_to_page pagination_showing_per_page %}

{% block main %}

<div id="corpus-text-list">

    <!-- List Options  -->
    <section>

        <div id="corpus-text-list-options-toggler">
            <!-- Inactive (show left arrow, to signal sliding in) -->
            <div id="corpus-text-list-options-toggler-inactive">
                <i class="far fa-caret-square-left"></i>
            </div>
            <!-- Active (show right arrow, to signal sliding out) -->
            <div id="corpus-text-list-options-toggler-active">
                <i class="far fa-caret-square-right"></i>
            </div>
        </div>

        <form method="GET" id="corpus-text-list-options">

            <!-- Showing -->
            <div id="corpus-text-list-options-showing">
                <div>
                    Found {{ page_obj.paginator.count }} texts {% if page_obj.paginator.count != count_all_texts %}<a class="reset-form" href="#">(of all {{ count_all_texts }} texts)</a>{% endif %}
                </div>
                <div>
                    {% pagination_showing_per_page per_page=page_obj.paginator.per_page current_page=page_obj.number count_total_pages=page_obj.paginator.num_pages count_total_items=count_all_texts items_name='texts' %}
                </div>
            </div>

            <!-- List Pagination, if there are multiple pages -->
            {% if page_obj.paginator.num_pages > 1 %}
                <div id="corpus-text-list-options-pagination">
                    <div class="corpus-text-list-options-pagination-goto">Go to Page:</div>

                    <!-- First Page -->
                    <div class="corpus-text-list-options-pagination-action{% if page_obj.has_previous == False %} disabled{% endif %}">
                        <a class="fas fa-angle-double-left" {% if page_obj.has_previous %}href="{% pagination_go_to_page page_number=1 %}"{% endif %} title="First"></a>
                        <span>First</span>
                    </div>
                    <!-- Previous Page -->
                    <div class="corpus-text-list-options-pagination-action{% if page_obj.has_previous == False %} disabled{% endif %}">
                        <a class="fas fa-angle-left" {% if page_obj.has_previous %}href="{% pagination_go_to_page page_number=page_obj.previous_page_number %}"{% endif %} title="Previous"></a>
                        <span>Previous</span>
                    </div>
                    <!-- Next Page -->
                    <div class="corpus-text-list-options-pagination-action{% if page_obj.has_next == False %} disabled{% endif %}">
                        <a class="fas fa-angle-right" {% if page_obj.has_next %}href="{% pagination_go_to_page page_number=page_obj.next_page_number %}"{% endif %} title="Next"></a>
                        <span>Next</span>
                    </div>
                    <!-- Last Page -->
                    <div class="corpus-text-list-options-pagination-action{% if page_obj.has_next == False %} disabled{% endif %}">
                        <a class="fas fa-angle-double-right" {% if page_obj.has_next %}href="{% pagination_go_to_page page_number=page_obj.paginator.num_pages %}"{% endif %} title="Last"></a>
                        <span>Last</span>
                    </div>
                </div>
            {% endif %}

            <hr>

            <!-- Search (allows for multiple search criteria) -->
            <div class="corpus-text-list-options-subtitle">Search</div>
            <!-- Hidden fields that will have value determined in JS -->
            <input type="hidden" id="corpus-text-list-options-search-values" name="search">
            <input type="hidden" id="corpus-text-list-options-search-operator" name="search_operator">
            <!-- Search fields (dynamically filled via JS) -->
            <div id="corpus-text-list-options-search-fields"></div>
            <div id="corpus-text-list-options-search-fields-add"><i class="fas fa-plus"></i> Add search box</div>

            <!-- Sort -->
            <div class="corpus-text-list-options-subtitle">Sort</div>
            <!-- Sort by -->
            <label for="corpus-text-list-options-sort-by">Sort by:</label>
            <select id="corpus-text-list-options-sort-by" name="sort_by">
                <!-- Alphabetical sorts (options defined in view) -->
                {% if options_sortby_alphabetical|length > 0 %}
                    {% for osa in options_sortby_alphabetical %}
                        <option value="{{ osa.value }}">{{ osa.label }}</option>
                    {% endfor %}
                {% endif %}
                <!-- Numerical sorts (options defined in view) -->
                {% if options_sortby_numerical|length > 0 %}
                    {% for osn in options_sortby_numerical %}
                        <option value="{{ osn.value }}">{{ osn.label }}</option>
                    {% endfor %}
                {% endif %}
            </select>
            <!-- Sort direction -->
            <label for="corpus-text-list-options-sort-direction">Sort direction:</label>
            <select id="corpus-text-list-options-sort-direction" name="sort_direction">
                <option value="">Ascending (A-Z, 0-9)</option>
                <option value="-">Descending (Z-A, 9-0)</option>
            </select>

            <!-- Filter -->
            {% if options_filters|length > 0 %}
                <div class="corpus-text-list-options-subtitle">Filters</div>
                <div class="corpus-text-list-options-filters">
                    {% for filter_group in options_filters %}
                        <div class="corpus-text-list-options-filters-group">
                            {% for f in filter_group %}
                                <div class="corpus-text-list-options-filters-group-filter">
                                    <label for="{{ f.filter_id }}">
                                        {{ f.filter_name }}
                                    </label>
                                    <span class="input-clear"><i class="fas fa-times-circle"></i></span>
                                    <select id="{{ f.filter_id }}"
                                        class="corpus-text-list-options-filters-group-filter{% if f.filter_classes %} {{ f.filter_classes }}{% endif %}"
                                        title="{{ f.filter_id }}"
                                        name="{{ f.filter_id }}"

                                        {# Filter Dependencies #}
                                        {% if f.filter_dependencies %}data-dependencies="{{ f.filter_dependencies }}" {% endif %}

                                        {# Data Hierarchy #}
                                        {% if f.data_hierarchy_id %}data-hierarchy-id="{{ f.data_hierarchy_id }}" {% endif %}
                                        {% if f.data_hierarchy_parents %}data-hierarchy-parents="{{ f.data_hierarchy_parents }}" {% endif %}
                                        {% if f.data_hierarchy_children %}data-hierarchy-children="{{ f.data_hierarchy_children }}" {% endif %}>
                                        {% include 'snippets/select-default.html' %}
                                        {% for o in f.filter_options %}
                                            <option value="{% if o.html_select_value_field %}{{ o.html_select_value_field }}{% else %}{{ o.id }}{% endif %}"{% if o.data_hierarchy_parents_ids %} data-hierarchy-parents-ids="{{ o.data_hierarchy_parents_ids }}"{% endif %}>{{ o }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            {% endfor %}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}

            <div class="corpus-text-list-options-submitbuttons">
                <button id="corpus-text-list-options-submit" class="corpus-text-list-options-submitbuttons-primary">
                    <i class="fas fa-search"></i> Search
                </button><!--
                --><button id="corpus-text-list-options-reset" title="Reset search" class="reset-form corpus-text-list-options-submitbuttons-secondary">
                    <i class="fas fa-redo-alt"></i>
                </button>
            </div>
        </form>
    </section>

    <!-- List Items -->
    <section id="corpus-text-list-items">
        {% for object in object_list %}
            <!-- Set the URL based on the main model supplied to this page -->
            <a href="{% url 'corpus:text-detail' object.id %}" class="corpus-text-list-items-item">
                <!-- Text -->
                <div class="corpus-text-list-items-item-text">
                    <div class="corpus-text-list-items-item-text-title">{{ object.title }}</div>
                    <div class="corpus-text-list-items-item-text-details">
                        <div>{{ object.description }}</div>
                    </div>
                </div>
                {% if object.image_thumbnail %}
                    <!-- Image -->
                    <div class="corpus-text-list-items-item-imagecontainer">
                        <img src="{{ object.image_thumbnail.url }}" alt="Image of corpus text">
                    </div>
                {% endif %}
            </a>
        {% empty %}
            <div class="corpus-text-list-items-empty">
                <div class="corpus-text-list-items-empty-title">
                    No records found
                </div>
                <div class="corpus-text-list-items-empty-details">
                    This may be because no data of this type exists yet or because your search criteria is too narrow
                </div>
            </div>
        {% endfor %}
    </section>

    

</div>


<!-- JS -->
<script>
    $(document).ready(function() {
        {% include "corpus/snippets/list.js" %}
    });
</script>

{% endblock %}